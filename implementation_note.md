> NOTE: This article is only avalible in Simplified Chinese.

# Rizlium 实现笔记
首先我毕竟也没有写 doc 的经验, 所以与其将这个文件看作是严谨的笔记, 不如只把它作为参考()
## 1. 插件系统
我在写 Rizlium Editor 的时候注重模块化, 虽然一开始比较石山, 但后来我设计了这样一个插件的系统.  
不过目前, 它不同于可以热插拔的传统意义上的插件, 而是改变之后要重新编译的.(要把它改成热插拔的也不会太难)  
是这样的: 它以 Bevy 自身的插件系统为基础, 通过在`App`结构体上定义的扩充trait实现了对如下几个功能的模块化修改:

- 热键
- 菜单栏
- 操作<div style = "color:grey"> (相当于动态调用函数) </div>
- 选项卡 <div style = "color:grey"> (或者说 docking windows) </div>
- 设置的选项

这里面菜单栏会通过操作的 id (一个`DotPath`, 由点分隔的路径)调用操作, 热键也一样.

虽说由于实现的时间跨度太大, 代码库不同部分的风格和遵循的原则也各不相同吧(哭笑不得)

### 1.1 热键
热键是这样工作的: 有四种触发方式, 定义于`rizlium_editor/src/hotkeys.rs:TriggerType`中.
这几个触发方式顾名思义, 是按下和/或抬起时触发一次, 或者只要按着就每一帧触发.

一些细节如下:

1. 对应一个组合键的时候, 需要除最后一个键外其他的键正按着, 且最后一个键满足了它的`TriggerType`的触发方式.
2. 如果正在编辑文字(输入文本), 只有快捷键中含有`ctrl`或`alt`才允许触发.
3. 快捷键可以带一个`condition`, 这是个从`World` 得到一个布尔值的函数, 表示是否应该触发这个热键.
4. 用于热键的操作可以以一个`RuntimeTrigger`为输入, 或者什么输入都没有.  
这个 `RuntimeTrigger`表示它到底是如何触发的, 只可能是按下/抬起/按着中.

调用`App`上的`register_hotkey` 方法可以注册热键. 每个操作可以对应多个不同的热键.

### 1.2 菜单栏

*Todo.*